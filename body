import random
from telebot import types
import telebot

bot = telebot.TeleBot('5271490601:AAFhpRSWLetHBysjghjdttDT-ZLR4yNoGOs')

number = 8    #переменная, которая используется для определения кольчества бросков, по умолчанию дла фаербола 3 уровнем

@bot.message_handler(commands=["start"])
def start(message, res=False):
    """Команда, просто присылает в чат смайлик кубика
    """
    bot.send_message(message.chat.id, 'Хачу рандомить', parse_mode='html')

@bot.message_handler(commands=["dice"])
def dice(message):
    bot.send_dice(message.chat.id)

@bot.message_handler(commands=["roll"])
def roll(message):
    """Команда, вызывает меню с кнопками в области ввода текста, кнопки пишут в чат фразы,
       ожидаемые get_user_text'ом
    """
    markup = types.ReplyKeyboardMarkup(resize_keyboard=True)
    D4 = types.KeyboardButton('D4')
    D6 = types.KeyboardButton('D6')
    D8 = types.KeyboardButton('D8')
    D10 = types.KeyboardButton('D10')
    D12 = types.KeyboardButton('D12')
    D20 = types.KeyboardButton('D20')
    markup.add(D4, D6, D8, D10, D12, D20)
    bot.send_message(message.chat.id, 'Выбери кубас', reply_markup=markup, disable_notification=True)

@bot.message_handler(commands=['d_twelve'])
def d_twelve(message):
    """Команда, ролит Д12, была просто пробой пера"""
    bot.send_message(message.chat.id, f'{random.randint(1, 12)}', parse_mode='html', disable_notification=True)

@bot.message_handler(content_types=['text'])
def get_user_text(message):
    """НЕ комманда, смотрит на сообщения в чате, пишет ответ на ключи, в данный момент еще и рандомит, и считает,
       но никогда этого не хотела
    """
    global number
    if message.text == "D12":
        bot.send_message(message.chat.id, f'Результат: {[random.randint(1, 12) for each in range(number)]}, а всего {sum([random.randint(1, 12) for each in range(number)])}',
                         disable_notification=True)
    elif message.text == "D4":
        bot.send_message(message.chat.id, f'Результат: {[random.randint(1, 4) for each in range(number)]}, а всего {sum([random.randint(1, 4) for each in range(number)])}',
                         disable_notification=True)
    elif message.text == "D6":
        bot.send_message(message.chat.id, f'Результат: {[random.randint(1, 6) for each in range(number)]}, а всего {sum([random.randint(1, 6) for each in range(number)])}',
                         disable_notification=True)
    elif message.text == "D8":
        bot.send_message(message.chat.id, f'Результат: {[random.randint(1, 8) for each in range(number)]}, а всего {sum([random.randint(1, 8) for each in range(number)])}',
                         disable_notification=True)
    elif message.text == "D10":
        bot.send_message(message.chat.id, f'Результат: {[random.randint(1, 10) for each in range(number)]}, а всего {sum([random.randint(1, 10) for each in range(number)])}',
                         disable_notification=True)
    elif message.text == "D20":
        bot.send_message(message.chat.id, f'Результат: {[random.randint(1, 20) for each in range(number)]}, а всего {sum([random.randint(1, 20) for each in range(number)])}',
                         disable_notification=True)
    elif message.text == '/dices':
        bot.send_message(message.chat.id, 'Сколько нужно бросать?', disable_notification=True)
        bot.register_next_step_handler(message, get_dices)

def get_dices(message):
    """Получает сообщение, берет из него целое число и присваивает number это значение"""
    try:
        number = int(message.text)
    except Exception:
        bot.send_message(message.chat.id, 'Одну цифру мне дай!', disable_notification=True)
    bot.send_message(message.chat.id, f'Хорошечно, будет {number}', disable_notification=True)



list_four = [random.randint(1,4) for each in range(number)]      #Останки былой роскоши, попытка сделать листы для
list_six = [random.randint(1, 6) for each in range(number)]      #подсчетов, разбилась об необходимость ролить все заново
list_eight = [random.randint(1, 8) for each in range(number)]
list_ten = [random.randint(1, 10) for each in range(number)]
list_twelve = [random.randint(1, 12) for each in range(number)]
list_twenty = [random.randint(1, 20) for each in range(number)]



#@bot.message_handler()
#def get_number(message, x):
#    if message.text ==

bot.polling(non_stop=True) #Бот не выключается сам
